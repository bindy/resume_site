var SiteJc=function(){function e(){s();var e=$(document).width(),o=$(document).height(),n=0,i=1,l=2,c=0,d=$("#ID_body"),p=$("#ID_section section"),h=p.length,f=$("#ID_section"),w=$("#ID_nav"),m=$("#ID_nav li"),u=$("#ID_tab"),v=$("#ID_contact .letter"),g=$("#ID_work_wrap .work"),b=$("#ID_work_wrap .photo"),_=$("#ID_workList"),x=$("#ID_photoList"),C=$("#ID_work_wrap li"),k=$("#ID_page"),y=k.find(".scrollbar"),I=k.width(),D=g.width(),j=b.width(),T=(C.length,k.offset()),O='<div class="overlay"></div>';f.height(o*h),p.height(o),$(window).resize(function(){T=k.offset()});var L=0,E=0;$(window).on("mousewheel",function(e){var t=e.wheelDelta;t>120?t=120:-120>t&&(t=-120),console.log(t),E+=t,L-E==240?(c+=1,L=E):E-L==240&&(c-=1,L=E),3==c?c=0:-1==c&&(c=2),2==c?(v.forEach(function(e,t){$(e).addClass("bg-le"+t)}),$("#ID_plane").addClass("appear"),$(".arrow .ico-arrow").css("-webkit-transform","rotate(180deg)")):$(".arrow .ico-arrow").css("-webkit-transform","rotate(0)"),null==$(".popup").html()&&(f.css("-webkit-transform","translateY("+-c*o+"px)"),m.siblings().removeClass("current"),m.eq(c).addClass("current"))}),a(_),r(x),d.on("keydown",function(t){var a=t.keyCode,r=k.find(".scrollbar"),s=r.width(),o=u.find(".current").hasClass("item-hand")?"hand":"photo",n=80;if(w.find(".current ico-work")){"39"==a?s+n>I?r.width(I):r.width(s+n):"37"==a&&(20>s-n?r.width(20):r.width(s-n));var i=parseInt(r.css("width"));if("hand"==o){var l=_.width(),c=l-D,d=c/I,p=d*i;_.css("left",-p+"px")}else if("photo"==o){var l=x.width(),c=l-j,d=c/e,p=d*i;x.css("left",-p+"px"),20>=i&&x.css("left","140px")}}}),d.on("click",function(a){var r=a.target.className,s=a.target.tagName,p=$(a.target),w=a.x,u=w-T.left;if("arrow"==r||"ico-arrow"==r){var C="arrow"==r?p.find(".ico-arrow"):p;if(c+=1,c==h-1){C.css("-webkit-transform","rotate(180deg)"),v.forEach(function(e,t){$(e).addClass("bg-le"+t)});{$("#ID_line").get(0)}$("#ID_plane").addClass("appear"),t()}else c==h&&(c=0,C.css("-webkit-transform","rotate(0)"));f.css("-webkit-transform","translateY("+-c*o+"px)"),m.siblings().removeClass("current"),m.eq(c).addClass("current")}else if("btn-nav"==r||"ico"==r.slice(0,3)){var C=$("#ID_btn_play .ico-arrow");"ico-home"==r.slice(4)?c=n:"ico-work"==r.slice(4)?c=i:"ico-contact"==r.slice(4)&&(c=l,$("#ID_plane").addClass("appear"),t()),c==h-1?(C.css("-webkit-transform","rotate(180deg)"),v.forEach(function(e,t){$(e).addClass("bg-le"+t)})):C.css("-webkit-transform","rotate(0)"),f.css("-webkit-transform","translateY("+-c*o+"px)"),m.siblings().removeClass("current"),m.eq(c).addClass("current")}else if(r.indexOf("item")>=0&&("A"==s||"SPAN"==s)){p.parents("li").siblings().removeClass("current"),p.parents("li").addClass("current");var k=r.slice(5);y.width(20),"hand"==k?(u=0,g.removeClass("hide").addClass("show"),b.removeClass("show").addClass("hide"),_.css("left","0"),y.attr("data-type","c_hand")):"photo"==k&&(g.removeClass("show").addClass("hide"),b.removeClass("hide").addClass("show"),x.css("left","140px"),y.attr("data-type","c_photo"))}else if("page-wrap"==r||"scrollbar"==r){var L,E,M;if("page-wrap"==r?(M=p.find(".scrollbar"),u=w-T.left,M.width(u),20>u&&M.width(20)):"scrollbar"==r&&(M=p,M.width(u),20>u&&M.width(20)),"c_photo"==M.attr("data-type")?(E="true",L="false"):"c_hand"==M.attr("data-type")&&(L="true",E="false"),"true"==L){var N=_.width(),z=N-D,A=z/I,H=A*u;_.css("left",-H+"px")}else if("true"==E){var N=x.width(),z=N-j,A=z/e,H=A*u;x.css("left",-H+"px"),20>u&&x.css("left","140px")}}else if("item-work"==r){var q=null;if(void 0==$(".popup").get(0)){if("photo"==p.attr("data-type")){q='<div class="popup">			<div class="current-photo">			<img src="'+p.attr("src")+'" alt="">			</div>			<a href="#" class="btn-next" title="下一页"></a>			<a href="#" class="btn-prev" title="上一页"></a>			<a href="#" class="btn-close" title="关闭"></a>			</div>',d.append(q);var R=p.parent().index(),P=p.parents("ul").children().length;$(".popup .btn-next").on("click",function(){++R>P&&(R=1),$(".current-photo img").attr("src","photos/photo"+R+".jpg")}),$(".popup .btn-prev").on("click",function(){"0"==--R&&(R=P),$(".current-photo img").attr("src","photos/photo"+R+".jpg")})}else if("work"==p.attr("data-type")){var S=p.attr("data-work"),B=p.attr("data-num"),q='<div class="popup">			<ul class="list-photo"></ul>			<div class="current-photo"></div>			<a href="#" class="btn-close" title="关闭"></a>			</div>';d.append(q);for(var G="",Y='<img src="images/'+S+'/01.jpg" alt="">',Z=1;B>=Z;Z++)G+='<li><a href="#"><img src="images/'+S+"/0"+Z+'.jpg" alt="" data-index="'+Z+'"></a></li>';$(".popup .list-photo").append(G),$(".popup .current-photo").append(Y),$(".popup .list-photo img").on("click",function(){var e=$(this).attr("data-index");$(".popup .current-photo img").attr("src","images/"+S+"/0"+e+".jpg")})}}else d.find(".popup").removeClass("hide-scale").addClass("show-scale");d.append(O)}else(r.indexOf("overlay")>=0||"btn-close"==r)&&(d.find(".popup").removeClass("show-scale").addClass("hide-scale"),setTimeout(function(){d.find(".popup").remove()},500),d.find(".overlay").remove())})}function t(){$("#ID_form").on("keyup",function(){var e=/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/;$(".form-item").find('[data-func="valid"]').forEach(function(t){""!==$(t).val()?($(t).parent().siblings(".ico").addClass("ico-correct"),$(t).parent().removeClass("error"),"email"==$(t).attr("name")&&0==e.test($(t).val())&&(console.log(1),$(t).parent().addClass("error"),$(t).parent().siblings(".ico").removeClass("ico-correct"))):($(t).parent().addClass("error"),$(t).parent().siblings(".ico").removeClass("ico-correct"))}),3==$("#ID_form").find(".ico-correct").length?$("#ID_form .btn-submit").removeClass("false"):$("#ID_form .btn-submit").addClass("false")}),$("#ID_form .btn-submit").on("click",function(){var e=$(".name_cont").val(),t=$(".email_cont").val(),a=$(".comment_cont").val(),r=new Firebase("https://sitejc.firebaseio.com/");console.log([e,t,a]),r.push({name:e,email:t,comment:a}),$("#ID_form").remove(),$("#ID_feedback").removeClass("hide").addClass("show")})}function a(e){$.ajax({url:"http://love-swap.org/site_jc/workdata.json",dataType:"json",success:function(t){var a,r=Object.getOwnPropertyNames(t).length,s=new Image,o=16,n="work";for(var i in t){for(var l in t[i])s.src="http://love-swap.org/site_jc/"+t[i][l].src;var c=t[i][0].src.indexOf(".jpg"),d=t[i][0].src.slice(0,c)+"_s.jpg",p=t[i][0].src.indexOf("work"),h=t[i][0].src.indexOf("/0"),f=t[i][0].src.slice(p,h),w=t[i].length,m='<li><img class="item-work" src="'+d+'" alt="" data-work="'+f+'" data-type="'+n+'" data-num="'+w+'"></li>';e.append(m)}""!==e.html()&&(a=e.children("li").width()),r=Math.ceil(r/2);var u=a+o;e.width(u*r)},error:function(){console.log("error get data")}})}function r(e){$.ajax({url:"http://love-swap.org/site_jc/photodata.json",dataType:"json",success:function(t){var a,r=Object.getOwnPropertyNames(t).length,s=new Image,o=384,n="photo";for(var i in t){for(var l in t[i])s.src="http://love-swap.org/site_jc/"+t[i][l].src;var c=t[i][0].src.indexOf(".jpg"),d=t[i][0].src.slice(0,c)+".jpg",p='<li><img class="item-work" src="'+d+'" alt="" data-work="'+d+'" data-type="'+n+'"></li>';e.append(p)}""!==e.html()&&(a=e.children("li")),e.width(o*r)},error:function(){console.log("error get data")}})}function s(){var e=/(maxthon|360se|360ee|theworld|se|theworld|greenbrowser|qqbrowser|tencenttraveler)[\/]?[\w.]*/,t=/(chrome)[ \/]([\w.]+)/,a=/(msie) ([\w.]+)/,r=["",""],s=["","",""],o='<div class="ban-others">			<div class="face">			<div class="eyeL"></div>			<div class="eyeR"></div>			<div class="tearL"></div>			<div class="tearR"></div>			<p class="ban-text" id="banText"></p>			<div class="avatar-bg"></div>			</div>			</div>',n=function(o){var n={},i=t.exec(o)||a.exec(o),l=e.exec(o)||s,c=function(){try{var e=external.twGetRunPath.toLowerCase().indexOf("360se")>-1?!0:!1;if(e)try{var t=external.twGetRunVersion(external.twGetSecurityID(window));return["360se",t]}catch(a){return["360se","-"]}return r}catch(a){return r}}(),d=function(){try{return/(\d+\.\d)/.test(external.max_version)?["maxthon",parseFloat(RegExp.$1)]:r}catch(e){return r}}();return null!==i&&(n.core=[i[1],i[2]],n.shell=[l[1],l[2]]),c[0]?n.shell=c:d[0]&&(n.shell=d),n},i=navigator.userAgent.toLowerCase(),l=n(i);if(void 0!==l.core){var c=l.core.join("/"),d=(l.shell.join("/"),c.indexOf("/")),d=c.indexOf("chrome/");if(d>=0){c=c.replace("chrome/","");var p=c.substr(0,2);32>p?(document.body.innerHTML=o,document.getElementById("banText").innerHTML="您的浏览器需要更新了TT"):$(".preload").remove()}else 0>d&&(document.body.innerHTML=o,document.getElementById("banText").innerHTML='只有Chrome才能看到我TT，<a target="_blank" href="https://www.google.com/intl/zh-CN/chrome/browser/thankyou.html?statcb=1&installdataindex=defaultbrowser#">马上去下载</a>')}else document.body.innerHTML=o,document.getElementById("banText").innerHTML='只有Chrome才能看到我TT，<a target="_blank" href="https://www.google.com/intl/zh-CN/chrome/browser/thankyou.html?statcb=1&installdataindex=defaultbrowser#">马上去下载</a>'}return{init:e}}();SiteJc.init();